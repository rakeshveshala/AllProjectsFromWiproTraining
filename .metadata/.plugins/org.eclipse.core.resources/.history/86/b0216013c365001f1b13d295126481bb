package com.wipro.demo.controller;

import java.util.List;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.wipro.demo.dao.EmployeeRepository;
import com.wipro.demo.model.Employee;

@RestController
@RequestMapping("/employees")
public class EmployeeController {
	@Autowired
	EmployeeRepository emprep;
	@GetMapping("/retreiveAll")
	public List<Employee> retreiveAllEmployees()
	{
		return emprep.findAll();
	}
	@PostMapping("/insert")
	public Employee insertData(@RequestBody Employee e)
	{
		return emprep.save(e);
	}
	@DeleteMapping("/Delete{empid}")
	public void deleteData(@PathVariable("empid") int id)
	{
		emprep.deleteById(id);
	}
	@PutMapping("/Update/{empid}")
	public Employee updateData(@PathVariable("empid") int id,@RequestBody Employee eupdate)
	{
		Optional<Employee> data=emprep.findById(id);
		Employee updatedEmployee=null;
		if(data.isPresent()) 
		{
			updatedEmployee=data.get();
			updatedEmployee.setEmpname(eupdate.getEmpname());
			updatedEmployee.setSalary(eupdate.getSalary());
			updatedEmployee.setDepartmentname(eupdate.getDepartmentname());
			updatedEmployee.setAddress(eupdate.getAddress());
			emprep.save(updatedEmployee); 
		}
		return updatedEmployee;
	}
}